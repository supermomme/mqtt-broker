version: "3"
services:
  client:
    build:
      context: ./client
      dockerfile: ./Dockerfile
    container_name: client_prod
    tty: true
    depends_on:
      - api
    networks:
      mqtt-dashboard:
      pub:
        ipv4_address: 10.0.100.11
    restart: always
  api:
    build: ./api
    container_name: api_prod
    environment:
      - NODE_ENV=production
    depends_on:
      - mongo
    networks:
      mqtt-dashboard:
      pub:
        ipv4_address: 10.0.100.10
    restart: always
  mongo:
    image: mongo:3.6
    container_name: mongo_prod
    volumes:
       - mongodb-data_prod:/data/db
    logging:
      driver: none
    networks:
      mqtt-dashboard:
      pub:
        ipv4_address: 10.0.100.9
    restart: always

volumes:
  mongodb-data_prod:

networks:
  mqtt-dashboard:
  pub:
    external: true
